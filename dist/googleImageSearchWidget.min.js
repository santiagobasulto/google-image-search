/*! googleImageSearchWidget 2014-07-28 */
!function(a,b){var c=function(){var b=null;return b||(b={getGoogleSearchService:function(b){var c=this,d={searchUrl:"https://www.googleapis.com/customsearch/v1?searchType=image",apiKey:null,cx:null,resultCount:10,startingPage:1,requestHandler:function(b){return a.ajax({url:b,type:"GET",async:!1})}};this.options=a.extend({},d,b);var e=function(a){return 1+(a-1)*c.options.resultCount};return{search:function(a){var b=c.options.startingPage,d=c.options.searchUrl,f=[],g=0,h=c.options.requestHandler,i=function(){var g=d;g+="&key="+c.options.apiKey,g+="&cx="+c.options.cx,g+="&q="+a,g+="&start="+e(b),g+="&num="+c.options.resultCount;var i=h(g);b++;for(var j=i.responseJSON.items,k=0;k<j.length;k++){var l=j[k];f.push(l)}};return{next:function(){return g<=f.length&&i(),f[g++]},rewind:function(){g=0}}}}}}),b};b.getGoogleFactory=c}(jQuery,window,document),$.widget("salesboard.imageCarouselWidget",{options:{visibleImages:3,defaultImageIterator:null,fetchOnCreation:!0,defaultWidth:null,defaultHeight:null,defaultResultsContainerClass:"js-image-carousel-widget-results-container",defaultNavClass:"js-image-carousel-widget-gif-nav",defaultPrevNavClass:"js-image-carousel-widget-gif-nav-prev",defaultNextNavClass:"js-image-carousel-widget-gif-nav-next",defaultResultElementClass:"result",defaultEventNameImageClicked:"image-clicked"},_create:function(){if(this.options.fetchOnCreation&&!this.options.defaultImageIterator)throw"This widget needs an image iterator to get the images";this.iterator=this.options.defaultImageIterator,this._images=[],this._firstImageIdx=0,this._createElements(),this.options.fetchOnCreation&&this._initImages()},resetIterator:function(a){this.iterator=a,this._images=[],this._initImages()},_initImages:function(){for(var a=0;a<this.options.visibleImages;a++){var b=this.iterator.next();this._images.push(b)}this._renderImages(),this.show()},_createElements:function(){var a=this;this._$results=$("<div />").addClass(this.options.defaultResultsContainerClass).appendTo(this.element),this._$nav=$("<div />").addClass(this.options.defaultNavClass).appendTo(this.element).hide(),this._$prev=$("<div />").addClass(this.options.defaultPrevNavClass).on("click",function(){a.prev()}).appendTo(this._$nav).hide(),this._$next=$("<div />").addClass(this.options.defaultNextNavClass).on("click",function(){a.next()}).appendTo(this._$nav).hide()},next:function(){this._firstImageIdx++,this._images.length<=this._firstImageIdx+this.options.visibleImages&&this._images.push(this.iterator.next()),this._renderImages()},prev:function(){this._firstImageIdx>0&&this._firstImageIdx--,this._renderImages()},_setVisibility:function(a){$.each([this._$results,this._$nav,this._$prev,this._$next],function(b,c){c[a]()})},show:function(){this._setVisibility("show")},hide:function(){this._setVisibility("hide")},_createImageElement:function(a){var b=this,c=$("<div></div>").addClass(this.options.defaultResultElementClass),d=$("<img />").attr("src",a.url).on("click",function(c){b._trigger(b.options.defaultEventNameImageClicked,c,{image:a})}).appendTo(c),e=a.width||this.options.defaultWidth,f=a.height||this.options.defaultHeight;return e&&d.attr("width",e),f&&d.attr("height",f),c},_renderImages:function(){this._$results.empty();for(var a=this._firstImageIdx+this.options.visibleImages,b=this._firstImageIdx;a>b;b++){var c=this._images[b],d=this._createImageElement(c);d.appendTo(this._$results)}}}),function(a){a.widget("salesboard.imageContainer",{options:{defaultWidth:null,defaultHeight:null,limit:null,defaultListContainer:"<ul></ul>",defaultListContainerSelector:"ul",defaultListContainerClass:"js-googleImage-ImageContainer-ul",defaultListElement:"<li></li>",defaultListElementSelector:"li",defaultListElementClass:"js-googleImage-ImageContainer-li",defaultListElementContainer:"<div></div>",defaultListElementContainerSelector:"div",defaultListElementContainerClass:"js-googleImage-ImageContainer-list-element-container",defaultImgElementClass:"js-googleImage-ImageContainer-img",defaultButtonClass:"js-googleImage-ImageContainer-button",defaultEventNameForImageAdded:"image-added",defaultEventNameForImageRemoved:"image-removed",defaultEventNameForLimitReached:"limit-reached"},_create:function(){this._images=[],this._initElements()},_primeElementIsList:function(){return this.element.prop("tagName")===a(this.options.defaultListContainer).prop("tagName")},_initElements:function(){if(this._primeElementIsList())this.listContainer=this.element;else{var b=a(this.options.defaultListContainer);b.addClass(this.options.defaultListContainerClass),this.element.append(b),this.listContainer=this.element.find(this.options.defaultListContainerSelector)}},_closeButtonClickedClosure:function(b){return function(){$this=a(this);var c=$this.parent(b.options.defaultListElementContainerSelector),d=c.find("img");b.removeImage({url:d.attr("src")})}},_createImageTag:function(b){var c=a(this.options.defaultListElementContainer).addClass(this.options.defaultListElementContainerClass),d=(a('<a role="button" href="#"></a>').css("display","inline-block").addClass(this.options.defaultButtonClass).append(a("<span></span>")).on("click",this._closeButtonClickedClosure(this)).appendTo(c),a("<img></img>").attr("src",b.url).addClass(this.options.defaultImgElementClass)),e=b.width||this.options.defaultWidth,f=b.height||this.options.defaultHeight;return e&&d.attr("width",e),f&&d.attr("height",f),c.append(d),c},_renderImages:function(){this.listContainer.html("");for(var b=0;b<this._images.length;b++){var c=this._images[b],d=a(this.options.defaultListElement);d.addClass(this.options.defaultListElementClass);var e=this._createImageTag(c);d.append(e),this.listContainer.append(d)}},currentImages:function(){return this._images},addImage:function(a){return this.options.limit&&this._images.length>=this.options.limit?(this._trigger(this.options.defaultEventNameForLimitReached,null,{images:this.currentImages()}),null):(this._images.push(a),this._trigger(this.options.defaultEventNameForImageAdded,null,{images:this.currentImages(),currentImageAdded:a}),void this._renderImages())},_getImageIndex:function(a){for(var b=0;b<this._images.length;b++){var c=this._images[b];if(c.url===a)return b}return null},removeImage:function(a){var b=a.url,c=this._getImageIndex(b);null!==c&&(this._images.splice(c,1),this._trigger(this.options.defaultEventNameForImageRemoved,null,{images:this.currentImages(),currentImageRemoved:a}),this._renderImages())},_destroy:function(){this.element.empty()}})}(jQuery,window,document);